<UserControl x:Class="BookingApp.Presentation.View.Guide.Controls.ReviewCardControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:BookingApp.Utilities">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Resources/ReviewsControlStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <local:StarConverter x:Key="StarConverter"/>
            <local:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <Border Style="{StaticResource ReviewCardStyle}">
        <StackPanel>
            <!-- Header -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                <TextBlock Text="{Binding TouristName}" FontWeight="Bold" FontSize="15"/>
                <TextBlock Text="INVALID" Foreground="Red" FontWeight="Bold" Margin="12,0,0,0" Style="{StaticResource InvalidTextStyle}"/>
            </StackPanel>

            <!-- Tour Info -->
            <TextBlock Text="{Binding TourName}" FontSize="13" Foreground="#444" Margin="0,0,0,4"/>
            <TextBlock FontWeight="Bold" FontSize="12" Margin="0,0,0,8">
                Key Point: <Run Text="{Binding KeyPointJoinedAt}" FontWeight="Normal"/>
            </TextBlock>

            <!-- Ratings -->
            <StackPanel Margin="0,0,0,10">
                <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                    <TextBlock Text="Knowledge: " FontWeight="Bold" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding GuideKnowledgeRating, Converter={StaticResource StarConverter}}" FontSize="16" Foreground="#FFD700"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                    <TextBlock Text="Language: " FontWeight="Bold" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding GuideLanguageRating, Converter={StaticResource StarConverter}}" FontSize="16" Foreground="#FFD700"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                    <TextBlock Text="Interesting: " FontWeight="Bold" Margin="0,0,4,0"/>
                    <TextBlock Text="{Binding TourInterestRating, Converter={StaticResource StarConverter}}" FontSize="16" Foreground="#FFD700"/>
                </StackPanel>
            </StackPanel>

            <!-- Comment -->
            <TextBlock Text="Comment:" FontWeight="Bold" Margin="0,0,0,4"/>
            <TextBlock Text="{Binding Comment}" TextWrapping="Wrap" Foreground="#333" Margin="0,0,0,12"/>

            <!-- Images -->
            <StackPanel Margin="0,0,0,12" Visibility="{Binding HasImages, Converter={StaticResource BoolToVisibilityConverter}}">
                <TextBlock Text="Images:" FontSize="12" FontWeight="Bold" Margin="0,0,0,5"/>
                <ListBox ItemsSource="{Binding ImagePaths}" Height="100" SelectionMode="Single" HorizontalAlignment="Left">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Image Source="{Binding}" Width="80" Height="80" Margin="5" ToolTip="Double-click to preview">
                                <Image.InputBindings>
                                    <MouseBinding MouseAction="LeftDoubleClick" Command="{Binding DataContext.OpenImageCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                                </Image.InputBindings>
                            </Image>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>

            <!-- Report Button -->
            <Button Content="Report" Command="{Binding DataContext.ReportCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" IsEnabled="{Binding IsValid}" Style="{StaticResource ReportButtonStyle}" ToolTip="Mark review as invalid"/>
        </StackPanel>
    </Border>

</UserControl>