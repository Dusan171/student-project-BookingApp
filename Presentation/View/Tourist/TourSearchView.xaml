<UserControl x:Class="BookingApp.Presentation.View.Tourist.TourSearchView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:BookingApp.Presentation.ViewModel.Tourist"
             xmlns:util="clr-namespace:BookingApp.Utilities"
             Loaded="OnLoaded" Unloaded="OnUnloaded">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <util:GreaterThanZeroConverter x:Key="GreaterThanZeroConverter"/>
        <util:InverseBooleanConverter x:Key="InverseBooleanConverter"/>

        <!-- Validation Error Style -->
        <Style x:Key="ValidationErrorStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#E74C3C"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Visibility" Value="Collapsed"/>
        </Style>

        <!-- Custom styles for modern look -->
        <Style x:Key="SearchTextBoxStyle" TargetType="TextBox">
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="35"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                          Padding="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#2E86C1"/>
                                <Setter Property="Background" Value="#F8FDFF"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="#85C1E9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Search Button Style - ZAOBLJEN kao ostali -->
        <Style x:Key="SearchButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2E86C1"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1F5F8B"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1A4F7A"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#BDC3C7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Clear Button Style - ZAOBLJEN -->
        <Style x:Key="ClearButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#95A5A6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#7F8C8D"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#6C7B7D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Details Button Style - ZAOBLJEN -->
        <Style x:Key="DetailsButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#9B59B6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#8E44AD"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#7D3C98"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Reserve Button Style - ZAOBLJEN -->
        <Style x:Key="ReserveTourButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{Binding ReserveButtonColor}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Language Radio Button Style -->
        <Style x:Key="LanguageRadioButtonStyle" TargetType="RadioButton">
            <Setter Property="Foreground" Value="#34495E"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse x:Name="RadioEllipse" Width="14" Height="14" 
                                     Stroke="#BDC3C7" StrokeThickness="2" 
                                     Fill="Transparent" Margin="0,0,8,0"/>
                            <Ellipse x:Name="RadioInner" Width="6" Height="6" 
                                     Fill="#3498DB" Visibility="Collapsed"
                                     Margin="-18,4,8,0"/>
                            <ContentPresenter VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="RadioEllipse" Property="Stroke" Value="#3498DB"/>
                                <Setter TargetName="RadioInner" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="RadioEllipse" Property="Stroke" Value="#85C1E9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Error Overlay Style -->
        <Style x:Key="ErrorOverlayStyle" TargetType="Grid">
            <Setter Property="Background" Value="#88000000"/>
            <Setter Property="Visibility" Value="Collapsed"/>
        </Style>

        <Style x:Key="ErrorPanelStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E74C3C"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="MaxWidth" Value="400"/>
        </Style>
    </UserControl.Resources>

    <Grid Background="#F8F9FA">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Search Panel -->
        <Border Grid.Column="0" Background="White" Margin="15,15,8,15" CornerRadius="8" 
                BorderBrush="#E0E0E0" BorderThickness="1">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                <StackPanel>
                    <!-- Header -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <Viewbox Width="16" Height="16" Margin="0,0,8,0">
                            <Path Data="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" 
                                  Fill="#2E86C1"/>
                        </Viewbox>
                        <TextBlock Text="PRETRAGA TURA" FontSize="16" FontWeight="Bold" Foreground="#2C3E50"/>
                    </StackPanel>

                    <TextBlock Text="Pronađite idealnu turu za vas!" 
                               FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,20" TextWrapping="Wrap"/>

                    <!-- Search Fields sa validacijom -->
                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="Grad:" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="12" Foreground="#34495E"/>
                        <TextBox x:Name="CityTextBox" 
                                 Text="{Binding SearchCity, UpdateSourceTrigger=PropertyChanged}" 
                                 Style="{StaticResource SearchTextBoxStyle}"
                                 LostFocus="ValidateField"/>
                        <TextBlock x:Name="CityError" 
                                   Style="{StaticResource ValidationErrorStyle}"/>
                    </StackPanel>

                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="Država:" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="12" Foreground="#34495E"/>
                        <TextBox x:Name="CountryTextBox" 
                                 Text="{Binding SearchCountry, UpdateSourceTrigger=PropertyChanged}" 
                                 Style="{StaticResource SearchTextBoxStyle}"
                                 LostFocus="ValidateField"/>
                        <TextBlock x:Name="CountryError" 
                                   Style="{StaticResource ValidationErrorStyle}"/>
                    </StackPanel>

                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="Trajanje (sati):" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="12" Foreground="#34495E"/>
                        <TextBox x:Name="DurationTextBox" 
                                 Text="{Binding SearchDuration, UpdateSourceTrigger=PropertyChanged}" 
                                 Style="{StaticResource SearchTextBoxStyle}"
                                 LostFocus="ValidateField"/>
                        <TextBlock x:Name="DurationError" 
                                   Style="{StaticResource ValidationErrorStyle}"/>
                    </StackPanel>

                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="Broj ljudi:" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="12" Foreground="#34495E"/>
                        <TextBox x:Name="PeopleCountTextBox" 
                                 Text="{Binding SearchPeopleCount, UpdateSourceTrigger=PropertyChanged}" 
                                 Style="{StaticResource SearchTextBoxStyle}"
                                 LostFocus="ValidateField"/>
                        <TextBlock x:Name="PeopleCountError" 
                                   Style="{StaticResource ValidationErrorStyle}"/>
                    </StackPanel>

                    <!-- Language Selection sa ComboBox kao u TourRequestsView -->
                    <StackPanel Margin="0,0,0,20">
                        <TextBlock Text="Jezik:" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="12" Foreground="#34495E"/>
                        <ComboBox SelectedValuePath="Content" 
                                  SelectedValue="{Binding SearchLanguage, UpdateSourceTrigger=PropertyChanged}" 
                                  FontSize="13" Height="35" BorderBrush="#E0E0E0">
                            <ComboBoxItem Content="srpski"/>
                            <ComboBoxItem Content="engleski"/>
                            <ComboBoxItem Content="nemački"/>
                            <ComboBoxItem Content="francuski"/>
                            <ComboBoxItem Content="španski"/>
                            <ComboBoxItem Content="italijanski"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Buttons -->
                    <StackPanel>
                        <Button Command="{Binding SearchToursCommand}" 
                                Content="PRETRAŽI TURE" 
                                Style="{StaticResource SearchButtonStyle}"
                                Margin="0,0,0,8"
                                Click="OnSearchClick"
                                IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBooleanConverter}}"/>

                        <Button Command="{Binding ClearSearchCommand}" 
                                Content="Obriši pretragu" 
                                Style="{StaticResource ClearButtonStyle}"
                                Margin="0,0,0,10"/>
                    </StackPanel>

                    <!-- Status -->
                    <TextBlock Text="{Binding StatusMessage}" 
                               FontSize="11" Foreground="#7F8C8D" 
                               TextWrapping="Wrap" Margin="0,10,0,0"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Results Panel -->
        <Border Grid.Column="1" Background="White" Margin="8,15,15,15" CornerRadius="8" 
                BorderBrush="#E0E0E0" BorderThickness="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Results Header -->
                <Border Grid.Row="0" Background="#F8F9FA" Padding="20,15" 
                        CornerRadius="8,8,0,0" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
                    <StackPanel Orientation="Horizontal">
                        <Viewbox Width="16" Height="16" Margin="0,0,8,0">
                            <Path Data="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" 
                                  Fill="#27AE60"/>
                        </Viewbox>
                        <TextBlock Text="REZULTATI PRETRAGE" FontSize="16" FontWeight="Bold" 
                                   Foreground="#2C3E50" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding Tours.Count, StringFormat=' ({0} tura)'}" 
                                   FontSize="13" Foreground="#7F8C8D" 
                                   VerticalAlignment="Center" Margin="5,0,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Loading Indicator -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" 
                            VerticalAlignment="Center"
                            Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <TextBlock Text="Učitavanje..." FontSize="16" Foreground="#7F8C8D"/>
                </StackPanel>

                <!-- Tours List -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="15" 
                              Visibility="{Binding IsLoading, Converter={StaticResource InverseBooleanConverter}}">
                    <ItemsControl ItemsSource="{Binding Tours}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="White" BorderBrush="#E8E8E8" BorderThickness="1" 
                                        Margin="0,0,0,12" Padding="15" CornerRadius="6">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="15" Foreground="#2C3E50" Margin="0,0,0,6"/>

                                            <!-- Location, Duration, Language info -->
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                <!-- Location icon -->
                                                <Viewbox Width="12" Height="12" Margin="0,0,4,0">
                                                    <Path Data="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" 
                                                          Fill="#E74C3C"/>
                                                </Viewbox>
                                                <TextBlock Text="{Binding LocationText}" FontSize="12" Foreground="#7F8C8D"/>

                                                <!-- Duration icon -->
                                                <Viewbox Width="12" Height="12" Margin="12,0,4,0">
                                                    <Path Data="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z" 
                                                          Fill="#3498DB"/>
                                                </Viewbox>
                                                <TextBlock Text="{Binding DurationText}" FontSize="12" Foreground="#7F8C8D"/>

                                                <!-- Language icon -->
                                                <Viewbox Width="12" Height="12" Margin="12,0,4,0">
                                                    <Path Data="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z" 
                                                          Fill="#27AE60"/>
                                                </Viewbox>
                                                <TextBlock Text="{Binding Language}" FontSize="12" Foreground="#7F8C8D"/>
                                            </StackPanel>

                                            <!-- Available spots -->
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                <Viewbox Width="12" Height="12" Margin="0,0,4,0">
                                                    <Path Data="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A2.98 2.98 0 0 0 17.1 7c-.8 0-1.54.5-1.85 1.26l-1.92 5.63c-.18.5.04 1.05.5 1.28.48.24 1.06.04 1.31-.43L16 12.5V22h4zM12.5 11.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5zM5.5 6c1.11 0 2-.89 2-2s-.89-2-2-2-2 .89-2 2 .89 2 2 2zm2.5 16v-7H6V9.5A2.5 2.5 0 0 0 3.5 7 2.5 2.5 0 0 0 1 9.5V15h1.5v7h5.5z" 
                                                          Fill="#F39C12"/>
                                                </Viewbox>
                                                <TextBlock Text="{Binding AvailableSpotsText}" FontSize="12" FontWeight="SemiBold" Foreground="{Binding AvailableSpotsColor}"/>
                                            </StackPanel>

                                            <!-- Mock podatci za opis i vodiča -->
                                            <TextBlock FontSize="11" Foreground="#95A5A6" TextWrapping="Wrap" MaxWidth="450" Margin="0,0,0,6">
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="{}{0}">
                                                        <Binding Path="Description" TargetNullValue="Istražite najlepše delove ovog grada kroz jedinstveno turistićko iskustvo koje će vam omogućiti da upoznate istoriju, kulturu i tradiciju na autentičan način."/>
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                            <TextBlock FontSize="11" Foreground="#7F8C8D" FontStyle="Italic">
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="Vodič: {0}">
                                                        <Binding Path="GuideName" TargetNullValue="Marko Petrović - Profesionalni turistički vodič"/>
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </StackPanel>

                                        <!-- Action Buttons -->
                                        <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Center">
                                            <!-- Details Button -->
                                            <Button Command="{Binding DataContext.ViewTourDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                    CommandParameter="{Binding}" 
                                                    Style="{StaticResource DetailsButtonStyle}"
                                                    Margin="0,0,0,5">
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                    <Viewbox Width="12" Height="12" Margin="0,0,4,0">
                                                        <Path Data="M14 2H6c-1.1 0-2 .9-2 2L4 20c0 1.1.89 2 2 2h8c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z" 
                                                              Fill="White"/>
                                                    </Viewbox>
                                                    <TextBlock Text="DETALJI" FontSize="11" FontWeight="Bold"/>
                                                </StackPanel>
                                            </Button>

                                            <!-- Reserve Button -->
                                            <Button Command="{Binding DataContext.ReserveTourCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                    CommandParameter="{Binding}" 
                                                    Style="{StaticResource ReserveTourButtonStyle}"
                                                    Margin="0,0,0,0">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock FontSize="12" FontWeight="Bold">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Text" Value="REZERVIŠI"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding CanReserve}" Value="False">
                                                                        <Setter Property="Text" Value="POPUNJENO"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Error Overlay za web-like validaciju -->
        <Grid x:Name="ErrorOverlay" Grid.ColumnSpan="2" Style="{StaticResource ErrorOverlayStyle}">
            <Border Style="{StaticResource ErrorPanelStyle}" HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <Viewbox Width="20" Height="20" Margin="0,0,8,0">
                            <Path Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" 
                                  Fill="#E74C3C"/>
                        </Viewbox>
                        <TextBlock Text="GREŠKA VALIDACIJE" FontWeight="Bold" FontSize="14" Foreground="#E74C3C"/>
                    </StackPanel>

                    <TextBlock x:Name="ErrorMessage" 
                               Text="Molimo ispravite greške u formi:" 
                               FontSize="12" Foreground="#7F8C8D" 
                               Margin="0,0,0,15" TextWrapping="Wrap"/>

                    <Button Content="ZATVORI" 
                            Style="{StaticResource ClearButtonStyle}"
                            Click="CloseErrorOverlay"
                            HorizontalAlignment="Right"
                            MinWidth="80"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>