<UserControl x:Class="BookingApp.Presentation.View.Tourist.ComplexTourRequestsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        
        <Style x:Key="ValidationErrorStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#E74C3C"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Visibility" Value="Collapsed"/>
        </Style>

        
        <Style x:Key="ValidationTextBoxStyle" TargetType="TextBox">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="BorderBrush" Value="#D5DBDB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                          Padding="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#3498DB"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="#85C1E9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

       
        <Style x:Key="ErrorTextBoxStyle" TargetType="TextBox" BasedOn="{StaticResource ValidationTextBoxStyle}">
            <Setter Property="BorderBrush" Value="#E74C3C"/>
            <Setter Property="Background" Value="#FDEEEE"/>
        </Style>

        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E8E8E8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <Style x:Key="TabButtonStyle" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" Background="Transparent" BorderThickness="0,0,0,3" 
                                BorderBrush="Transparent" Padding="20,12" Cursor="Hand">
                            <TextBlock Text="{TemplateBinding Content}" FontSize="14" 
                                       FontWeight="SemiBold" Foreground="#7F8C8D" 
                                       HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#3498DB"/>
                                <Setter TargetName="border" Property="Background" Value="#F8FBFE"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F8F9FA"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CreateButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#27AE60"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="6" 
                                Padding="{TemplateBinding Padding}">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="+" FontSize="16" FontWeight="Bold" Margin="0,0,8,0"/>
                                <ContentPresenter VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#229954"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

       
        <Style x:Key="RoundedButtonStyle" TargetType="Button">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="6" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        
        <Style x:Key="ErrorOverlayStyle" TargetType="Grid">
            <Setter Property="Background" Value="#88000000"/>
            <Setter Property="Visibility" Value="Collapsed"/>
        </Style>

        <Style x:Key="ErrorPanelStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E74C3C"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="25"/>
            <Setter Property="MaxWidth" Value="500"/>
        </Style>

        <Style x:Key="SuccessPanelStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#27AE60"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="25"/>
            <Setter Property="MaxWidth" Value="500"/>
        </Style>
    </UserControl.Resources>

    <Grid x:Name="MainGrid">
        
        <Grid x:Name="RequestsListView" Background="#F4F6F7">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            
            <Border Grid.Row="0" Background="White" BorderBrush="#E8E8E8" BorderThickness="0,0,0,1">
                <StackPanel Margin="40,25,40,0">
                    <Grid Margin="0,0,0,25">
                        <TextBlock Text="SLOŽENI ZAHTEVI ZA TURE" FontSize="26" FontWeight="Bold" 
                       Foreground="#2C3E50" VerticalAlignment="Center"/>
                        <Button Content="Kreiraj složeni zahtev" Style="{StaticResource CreateButtonStyle}"
                    Click="CreateRequest_Click"
                    HorizontalAlignment="Right" VerticalAlignment="Center"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal">
                        <RadioButton Content="Moji zahtevi" Style="{StaticResource TabButtonStyle}" 
                         IsChecked="True" GroupName="Tabs"
                         Command="{Binding FilterCommand}" CommandParameter="Moji"/>
                        <RadioButton Content="Svi zahtevi" Style="{StaticResource TabButtonStyle}" 
                         GroupName="Tabs" Margin="5,0,0,0"
                         Command="{Binding FilterCommand}" CommandParameter="Svi"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="40,20">

                    
                    <Border Background="White" BorderBrush="#E8E8E8" BorderThickness="1" 
                            CornerRadius="10" Padding="50" Margin="0,20,0,0"
                            Visibility="{Binding HasNoRequests, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <StackPanel HorizontalAlignment="Center">
                            <Viewbox Width="64" Height="64" Margin="0,0,0,20">
                                <Path Data="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11z" 
                                      Fill="#BDC3C7"/>
                            </Viewbox>
                            <TextBlock Text="{Binding StatusMessage}" FontSize="16" 
                                       Foreground="#7F8C8D" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <ItemsControl ItemsSource="{Binding FilteredRequests}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource CardStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        
                                        <Grid Grid.Row="0" Margin="0,0,0,15">
                                            <StackPanel Orientation="Horizontal">
                                                <Border Width="4" Height="50" Margin="0,0,15,0" CornerRadius="2">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Status}" Value="PENDING">
                                                                    <Setter Property="Background" Value="#F39C12"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="ACCEPTED">
                                                                    <Setter Property="Background" Value="#27AE60"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="INVALID">
                                                                    <Setter Property="Background" Value="#E74C3C"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                </Border>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding LocationText}" FontSize="18" FontWeight="Bold" 
                                                               Foreground="#2C3E50"/>
                                                    <TextBlock Text="{Binding DateRangeText}" FontSize="13" Foreground="#7F8C8D" 
                                                               Margin="0,3,0,0"/>
                                                    <TextBlock Text="{Binding TotalParts, StringFormat='Delova: {0}'}" FontSize="12" 
                                                               Foreground="#7F8C8D" Margin="0,2,0,0"/>
                                                </StackPanel>
                                            </StackPanel>

                                            <StackPanel HorizontalAlignment="Right" VerticalAlignment="Center">
                                                <Border Padding="10,5" CornerRadius="4">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Status}" Value="PENDING">
                                                                    <Setter Property="Background" Value="#FEF5E7"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="ACCEPTED">
                                                                    <Setter Property="Background" Value="#E8F5E8"/>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Status}" Value="INVALID">
                                                                    <Setter Property="Background" Value="#FFEBEE"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                    <TextBlock Text="{Binding StatusText}" FontSize="12" FontWeight="SemiBold">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Status}" Value="PENDING">
                                                                        <Setter Property="Foreground" Value="#F39C12"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="ACCEPTED">
                                                                        <Setter Property="Foreground" Value="#27AE60"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="INVALID">
                                                                        <Setter Property="Foreground" Value="#E74C3C"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                          </TextBlock.Style>
                                                    </TextBlock>
                                                </Border>
                                                <TextBlock Text="{Binding AcceptedParts, StringFormat='Prihvaćeno: {0}'}" 
                                                           FontSize="11" Foreground="#7F8C8D" HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                            </StackPanel>
                                        </Grid>

                                        
                                        <Grid Grid.Row="1" Margin="0,0,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Kreiran:" FontSize="12" FontWeight="SemiBold" 
                                                           Foreground="#7F8C8D" Margin="0,0,0,3"/>
                                                <TextBlock Text="{Binding CreatedAt, StringFormat='dd.MM.yyyy'}" FontSize="14" Foreground="#34495E"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="Rok za važenje:" FontSize="12" FontWeight="SemiBold" 
                                                           Foreground="#7F8C8D" Margin="0,0,0,3"/>
                                                <TextBlock Text="{Binding InvalidationDeadline, StringFormat='dd.MM.yyyy'}" FontSize="14" Foreground="#34495E"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <Button Content="Detalji" Command="{Binding DataContext.ViewDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Background="#3498DB" Foreground="White" 
                                                        Style="{StaticResource RoundedButtonStyle}"/>
                                            </StackPanel>
                                        </Grid>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>
        </Grid>

       
        <Grid x:Name="CreateRequestView" Background="#AA000000" 
              Visibility="Collapsed">
            <Border Background="White" MaxWidth="900" MaxHeight="700" 
            CornerRadius="10" Margin="50" VerticalAlignment="Center">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="40,30">
                        
                        <Grid Margin="0,0,0,30">
                            <TextBlock Text="KREIRANJE SLOŽENOG ZAHTEVA" FontSize="24" FontWeight="Bold" 
                               Foreground="#2C3E50" VerticalAlignment="Center"/>
                            <Button Content="×" FontSize="24" FontWeight="Bold"
                            Click="CancelCreateRequest_Click"
                            Background="Transparent" Foreground="#7F8C8D"
                            BorderThickness="0" Cursor="Hand"
                            HorizontalAlignment="Right" Width="30" Height="30"/>
                        </Grid>

                        
                        <Border Background="#F8FBFE" BorderBrush="#E8E8E8" BorderThickness="1" 
                        CornerRadius="8" Padding="25" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="Dodaj deo složenog zahteva" FontSize="18" FontWeight="Bold" 
                                   Foreground="#2C3E50" Margin="0,0,0,20"/>

                                <TextBlock Text="Lokacija" FontSize="16" FontWeight="SemiBold" 
                                   Foreground="#2C3E50" Margin="0,0,0,15"/>
                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Grad *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                        <TextBox x:Name="CityTextBox" 
                                                 Text="{Binding NewPart.City, UpdateSourceTrigger=PropertyChanged}"
                                                 Style="{StaticResource ValidationTextBoxStyle}"
                                                 LostFocus="ValidateField"/>
                                        <TextBlock Text="{Binding CityError}" Style="{StaticResource ValidationErrorStyle}"
                                                   Visibility="{Binding HasCityError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Država *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                        <TextBox x:Name="CountryTextBox" 
                                                 Text="{Binding NewPart.Country, UpdateSourceTrigger=PropertyChanged}"
                                                 Style="{StaticResource ValidationTextBoxStyle}"
                                                 LostFocus="ValidateField"/>
                                        <TextBlock Text="{Binding CountryError}" Style="{StaticResource ValidationErrorStyle}"
                                                   Visibility="{Binding HasCountryError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>
                                </Grid>

                              
                                <TextBlock Text="Opis *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                <TextBox x:Name="DescriptionTextBox" 
                                         Text="{Binding NewPart.Description, UpdateSourceTrigger=PropertyChanged}"
                                         TextWrapping="Wrap" AcceptsReturn="True" Height="80" 
                                         Style="{StaticResource ValidationTextBoxStyle}"
                                         LostFocus="ValidateField"/>
                                <TextBlock Text="{Binding DescriptionError}" Style="{StaticResource ValidationErrorStyle}" Margin="0,0,0,20"
                                           Visibility="{Binding HasDescriptionError, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                                
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="15"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="15"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="15"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Jezik *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                        <ComboBox x:Name="LanguageComboBox" 
                                                  SelectedValuePath="Content" 
                                                  SelectedValue="{Binding NewPart.Language, UpdateSourceTrigger=PropertyChanged}" 
                                                  FontSize="14" Padding="10"
                                                  SelectionChanged="ValidateComboField">
                                            <ComboBoxItem Content="Srpski"/>
                                            <ComboBoxItem Content="Engleski"/>
                                            <ComboBoxItem Content="Nemački"/>
                                            <ComboBoxItem Content="Francuski"/>
                                        </ComboBox>
                                        <TextBlock Text="{Binding LanguageError}" Style="{StaticResource ValidationErrorStyle}"
                                                   Visibility="{Binding HasLanguageError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2">
                                        <TextBlock Text="Datum od *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                        <DatePicker x:Name="DateFromPicker" 
                                                    SelectedDate="{Binding NewPart.DateFrom}" 
                                                    FontSize="14" Padding="10"
                                                    SelectedDateChanged="ValidateDateField"/>
                                        <TextBlock Text="{Binding DateFromError}" Style="{StaticResource ValidationErrorStyle}"
                                                   Visibility="{Binding HasDateFromError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="4">
                                        <TextBlock Text="Datum do *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                        <DatePicker x:Name="DateToPicker" 
                                                    SelectedDate="{Binding NewPart.DateTo}" 
                                                    FontSize="14" Padding="10"
                                                    SelectedDateChanged="ValidateDateField"/>
                                        <TextBlock Text="{Binding DateToError}" Style="{StaticResource ValidationErrorStyle}"
                                                   Visibility="{Binding HasDateToError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="6">
                                        <TextBlock Text="Broj ljudi *" FontSize="13" FontWeight="SemiBold" Foreground="#34495E" Margin="0,0,0,8"/>
                                        <TextBox x:Name="NumberOfPeopleTextBox" 
                                                 Text="{Binding NewPart.NumberOfPeople, UpdateSourceTrigger=PropertyChanged}"
                                                 Style="{StaticResource ValidationTextBoxStyle}"
                                                 LostFocus="ValidateField"/>
                                        <TextBlock Text="{Binding NumberOfPeopleError}" Style="{StaticResource ValidationErrorStyle}"
                                                   Visibility="{Binding HasNumberOfPeopleError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                    </StackPanel>
                                </Grid>

                                
                                <TextBlock Text="Učesnici" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,15"/>
                                <TextBlock FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,10">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="Dodano učesnika: {0} od {1}">
                                            <Binding Path="CurrentParticipants.Count"/>
                                            <Binding Path="NewPart.NumberOfPeople"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>

                                <Border Background="#F8F9FA" BorderBrush="#E8E8E8" BorderThickness="1" 
                                CornerRadius="8" Padding="20" Margin="0,0,0,15">
                                    <StackPanel>
                                       
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                           
                                            <Grid Grid.Row="0" Margin="0,0,0,8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <TextBlock Grid.Column="0" Text="Ime *" FontSize="12" FontWeight="SemiBold" 
                                                          Foreground="#34495E"/>
                                                <TextBlock Grid.Column="2" Text="Prezime *" FontSize="12" FontWeight="SemiBold" 
                                                          Foreground="#34495E"/>
                                                <TextBlock Grid.Column="4" Text="Godine *" FontSize="12" FontWeight="SemiBold" 
                                                          Foreground="#34495E"/>
                                            </Grid>

                                           
                                            <Grid Grid.Row="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="15"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <StackPanel Grid.Column="0">
                                                    <TextBox x:Name="ParticipantFirstNameTextBox" 
                                                             Text="{Binding NewParticipant.FirstName, UpdateSourceTrigger=PropertyChanged}"
                                                             Style="{StaticResource ValidationTextBoxStyle}"
                                                             LostFocus="ValidateParticipantField"/>
                                                    <TextBlock Text="{Binding ParticipantFirstNameError}" Style="{StaticResource ValidationErrorStyle}"
                                                               Visibility="{Binding HasParticipantFirstNameError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="2">
                                                    <TextBox x:Name="ParticipantLastNameTextBox" 
                                                             Text="{Binding NewParticipant.LastName, UpdateSourceTrigger=PropertyChanged}"
                                                             Style="{StaticResource ValidationTextBoxStyle}"
                                                             LostFocus="ValidateParticipantField"/>
                                                    <TextBlock Text="{Binding ParticipantLastNameError}" Style="{StaticResource ValidationErrorStyle}"
                                                               Visibility="{Binding HasParticipantLastNameError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                                </StackPanel>

                                                <StackPanel Grid.Column="4">
                                                    <TextBox x:Name="ParticipantAgeTextBox" 
                                                             Text="{Binding NewParticipant.Age, UpdateSourceTrigger=PropertyChanged}"
                                                             Style="{StaticResource ValidationTextBoxStyle}"
                                                             LostFocus="ValidateParticipantField"/>
                                                    <TextBlock Text="{Binding ParticipantAgeError}" Style="{StaticResource ValidationErrorStyle}"
                                                               Visibility="{Binding HasParticipantAgeError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                                </StackPanel>

                                                <Button Grid.Column="6" Content="Dodaj" 
                                                        Click="AddParticipant_Click"
                                                        Background="#27AE60" Foreground="White" 
                                                        Style="{StaticResource RoundedButtonStyle}"
                                                        VerticalAlignment="Bottom"/>
                                            </Grid>

                                            
                                            <Grid Grid.Row="2" Margin="0,5,0,0">
                                                <TextBlock Text="{Binding ParticipantCountError}" Style="{StaticResource ValidationErrorStyle}"
                                                           Visibility="{Binding HasParticipantCountError, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                            </Grid>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                
                                <ItemsControl ItemsSource="{Binding CurrentParticipants}" Margin="0,0,0,20">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="White" BorderBrush="#E8E8E8" BorderThickness="1" 
                                            Padding="15,10" Margin="0,0,0,8" CornerRadius="6">
                                                <Grid>
                                                    <TextBlock Text="{Binding DisplayText}" FontSize="14" 
                                                       Foreground="#2C3E50" VerticalAlignment="Center"/>
                                                    <Button Content="Ukloni" 
                                                    Command="{Binding DataContext.RemoveParticipantCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                    CommandParameter="{Binding}"
                                                    Background="#E74C3C" Foreground="White" 
                                                    Style="{StaticResource RoundedButtonStyle}"
                                                    HorizontalAlignment="Right"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>

                                <Button Content="Dodaj ovaj deo zahteva" 
                                        Click="AddPart_Click"
                                        Background="#3498DB" Foreground="White" Padding="20,12" 
                                        FontSize="14" FontWeight="Bold" 
                                        Style="{StaticResource RoundedButtonStyle}"
                                        Margin="0,20,0,0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        
                        <Border Background="White" BorderBrush="#E8E8E8" BorderThickness="1" 
                        CornerRadius="8" Padding="20" Margin="0,0,0,20"
                        Visibility="{Binding HasParts, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel>
                                <TextBlock Text="{Binding TotalParts, StringFormat='Dodani delovi zahteva ({0}):'}" 
                                   FontSize="16" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,15"/>

                                <ItemsControl ItemsSource="{Binding CurrentParts}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#E8E8E8" BorderThickness="1" 
                                            Margin="0,0,0,10" Padding="15" CornerRadius="6"
                                            Background="#F8FBFE">
                                                <Grid>
                                                    <StackPanel>
                                                        <Grid Margin="0,0,0,8">
                                                            <TextBlock FontWeight="Bold" FontSize="14" Foreground="#2C3E50">
                                                                <TextBlock.Text>
                                                                    <MultiBinding StringFormat="Deo {0}: {1}">
                                                                        <Binding Path="PartIndex"/>
                                                                        <Binding Path="LocationText"/>
                                                                    </MultiBinding>
                                                                </TextBlock.Text>
                                                            </TextBlock>
                                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                                <Button Content="Edituj" 
                                                                Command="{Binding DataContext.EditPartCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                                CommandParameter="{Binding}"
                                                                Background="Transparent" Foreground="#3498DB" 
                                                                BorderBrush="#3498DB" BorderThickness="1"
                                                                Style="{StaticResource RoundedButtonStyle}"
                                                                Margin="0,0,5,0"/>
                                                                <Button Content="Ukloni" 
                                                                Command="{Binding DataContext.RemovePartCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                                CommandParameter="{Binding}"
                                                                Background="#E74C3C" Foreground="White" 
                                                                Style="{StaticResource RoundedButtonStyle}"/>
                                                            </StackPanel>
                                                        </Grid>

                                                        <TextBlock Text="{Binding LocationText}" FontSize="13" Foreground="#34495E" Margin="0,0,0,4"/>
                                                        <TextBlock Text="{Binding DateRangeText}" FontSize="12" Foreground="#7F8C8D" Margin="0,0,0,4"/>
                                                        <TextBlock Text="{Binding Language}" FontSize="11" Background="#F0F0F0" 
                                                           Padding="4,2" HorizontalAlignment="Left" Margin="0,0,0,4"/>
                                                        <TextBlock Text="{Binding NumberOfPeople, StringFormat='Učesnika: {0}'}" 
                                                           FontSize="12" Foreground="#7F8C8D"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                       
                        <TextBlock Text="{Binding RequestPartsError}" Style="{StaticResource ValidationErrorStyle}" 
                                   FontSize="14" Margin="0,0,0,15"
                                   Visibility="{Binding HasRequestPartsError, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Button Grid.Column="0" Content="Otkaži" 
                                    Click="CancelCreateRequest_Click"
                                    Background="#95A5A6" Foreground="White" 
                                    FontWeight="SemiBold" Style="{StaticResource RoundedButtonStyle}" 
                                    Padding="20,12"/>
                            <Button Grid.Column="2" Content="Kreiraj složeni zahtev" 
                                    Click="SaveRequest_Click"
                                    Background="#27AE60" Foreground="White" 
                                    FontWeight="Bold" Style="{StaticResource RoundedButtonStyle}"
                                    Padding="20,12"/>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        
        <Grid x:Name="SuccessOverlay" Style="{StaticResource ErrorOverlayStyle}">
            <Border Style="{StaticResource SuccessPanelStyle}" HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="✓" FontSize="24" FontWeight="Bold" Foreground="#27AE60" Margin="0,0,10,0"/>
                        <TextBlock Text="USPEŠNO KREIRAN" FontWeight="Bold" FontSize="16" Foreground="#27AE60"/>
                    </StackPanel>

                    <TextBlock x:Name="SuccessMessage" 
                               Text="Zahtev za složenu turu je uspešno kreiran!" 
                               FontSize="14" Foreground="#7F8C8D" 
                               Margin="0,0,0,20" TextWrapping="Wrap"/>

                    <Button Content="ZATVORI" 
                            Style="{StaticResource RoundedButtonStyle}"
                            Background="#27AE60" Foreground="White"
                            Click="CloseSuccessOverlay"
                            HorizontalAlignment="Right"
                            MinWidth="100"/>
                </StackPanel>
            </Border>
        </Grid>

       
        <Grid x:Name="ErrorOverlay" Style="{StaticResource ErrorOverlayStyle}">
            <Border Style="{StaticResource ErrorPanelStyle}" HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="!" FontSize="24" FontWeight="Bold" Foreground="#E74C3C" Margin="0,0,10,0"/>
                        <TextBlock Text="GREŠKA VALIDACIJE" FontWeight="Bold" FontSize="16" Foreground="#E74C3C"/>
                    </StackPanel>

                    <TextBlock x:Name="ErrorMessage" 
                               Text="Molimo ispravite greške u formi:" 
                               FontSize="14" Foreground="#7F8C8D" 
                               Margin="0,0,0,15" TextWrapping="Wrap"/>

                    <Button Content="ZATVORI" 
                            Style="{StaticResource RoundedButtonStyle}"
                            Background="#95A5A6" Foreground="White"
                            Click="CloseErrorOverlay"
                            HorizontalAlignment="Right"
                            MinWidth="100"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>